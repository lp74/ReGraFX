{"version":3,"file":"regrafx.js","sources":["../../src/subscription.js","../../src/subscribers.js","../../src/observable.js","../../src/observer.js","../../src/scheduler.js","../../src/token.js","../../src/message.js","../../src/tools.js","../../src/task.js","../../src/vertex.js","../../src/graph.js","../../src/composite/composite-vertex.js","../../src/search/dfs.js","../../src/regrafx.js"],"sourcesContent":["export class Subscription {\n  constructor(obj) {\n    this.id = Symbol();\n    this.unsubscribe = obj.unsubscribe.bind(obj, this.id);\n  }\n}","import { Subscription } from './subscription.js';\n\nexport class Subscribers {\n  constructor() {\n    this._subscribers = {};\n  }\n  subscribe(obj) {\n    const subscription = new Subscription(this);\n    this._subscribers[subscription.id] = obj;\n    return subscription;\n  }\n  unsubscribe(id) {\n    delete this._subscribers[id];\n  }\n  size() {\n    return this.ids().length;\n  }\n  ids() {\n    return Object.getOwnPropertySymbols(this._subscribers);\n  }\n  get(id) {\n    return this._subscribers[id];\n  }\n  set(obj) {\n    this._subscribers[id] = obj;\n  }\n  iterable() {\n    return Object.getOwnPropertySymbols(this._subscribers).map(s => this._subscribers[s]);\n  }\n}","import {Subscribers} from './subscribers.js';\n\nexport class Observable {\n  constructor(subscribers = new Subscribers() ) {\n    this.$$observers = subscribers;\n  }\n  subscribe(observer) {\n    return this.observers().subscribe(observer);\n  }\n  observers() {\n    return this.$$observers;\n  }\n  unsubscribe(id) {\n    this.observers().unsubscribe(id);\n  }\n  notify(...obj) {\n    for (const observer of this.observers().iterable()) {\n      observer.next(...obj);\n    }\n  }\n}\n","\nexport class Observer {\n  constructor(fn = () => undefined, name = 'Linked Observer') {\n    this._fn = fn;\n    this._name = name;\n  }\n  next(...input) {\n    return this._fn(...input);\n  }\n}\n","import { Observable } from './observable.js';\n\nexport class Scheduler {\n  constructor(delay = 0, pauser = new Observable()) {\n    this._delay = delay;\n    this._pause = 0;\n    this._pauser = pauser;\n  }\n  schedule() {\n    return new Promise((resolve, reject) => {\n      setTimeout(() => {\n        this.isRunning()\n          ? resolve()\n          : this._pauser.subscribe(x => {\n            this._pause = x;\n            if (this.isRunning()) {resolve();}\n          });\n      }, this._delay);\n    });\n  }\n  isRunning() {\n    return !this._pause;\n  }\n}\n","export class Token {\n  constructor() {\n    this.$$symbol = Symbol();\n    this.$$date = Date.now();\n    this.$$cancelled = false;\n  }\n  cancel() {\n    this.$$cancelled = true;\n  }\n}","import { Token } from './token';\n\nexport class Message {\n  constructor(origin) {\n    this.$$origin = origin;\n    this.$$date = Date.now();\n    this.$$token = new Token();\n    this.$$subject = null;\n    this.$$signatures = [];\n  }\n  subject(subject) { this.$$subject = subject; return this; }\n  sign(signature) { this.$$signatures.push(signature); return this; }\n  token() {return this.$$token;}\n}\n\nMessage.$$name = 'ReGraFX.Message';\n","export function isFunction(value) {\n  return typeof value === 'function' || false;\n}\n\nexport function isPromise(p) {\n  return p && isFunction(p.then);\n}\n\nexport function isMessage(obj) {\n  return (obj && obj.$$name && obj.$$name === 'ReGraFX.Message');\n}\n","import { isPromise } from './tools.js';\n\nexport class Task {\n  constructor(fn = () => null) {\n    this._fn = fn;\n  }\n  execute(...input) {\n    try {\n      const res = this._fn(...input);\n      return isPromise(res) ? res : Promise.resolve(res);\n    } catch (err) {\n      return Promise.reject(err);\n    }\n  }\n}\n","import { Observable } from './observable.js';\nimport { Observer } from './observer.js';\nimport { Scheduler } from './scheduler.js';\nimport { Message } from './message.js';\nimport { Task } from './task.js';\nexport class Vertex {\n  constructor(task = new Task(), scheduler = new Scheduler(), name = 'Vertex') {\n    this.$$task = task;\n    this.$$scheduler = scheduler;\n    this.$$name = name;\n\n    this.$$thenObservers = new Observable();\n    this.$$catchObservers = new Observable();\n    this.$$finallyObservers = new Observable();\n    this.$$observable = new Observable();\n\n    const boundVertexFn = this.$$next.bind(this);\n    boundVertexFn.boundVertex = this;\n    this.$$observer = new Observer(boundVertexFn, this.$$name);\n  }\n  $observer() {return this.$$observer;}\n  to(vertex) {\n    this.$$thenObservers.subscribe(vertex.$observer());\n    return this;\n  }\n  err(vertex) {\n    this.$$catchObservers.subscribe(vertex.$observer());\n    return this;\n  }\n  final(vertex) {\n    this.$$finallyObservers.subscribe(vertex.$observer());\n    return this;\n  }\n\n  subscribe(fn) {\n    this.$$observable.subscribe(new Observer(fn));\n  }\n\n  trigger(...input) {\n    const msg = new Message();\n    input.push(msg);\n    this.$$observer.next(...input);\n    return msg;\n  }\n  $$next(...input) {\n    const msg = input[input.length - 1];\n    if (!msg.token().$$cancelled) {\n      this.$$scheduler.schedule()\n        .then(() => {\n          const promise = this.$$task.execute(...input);\n          promise\n            .then(out => {\n              msg.sign(this.$$name);\n              this.$$thenObservers.notify(out, msg);\n            })\n            .catch(err => {\n              msg.sign(this.$$name);\n              this.$$catchObservers.notify(err, msg);\n            })\n            .finally(() => {\n              this.$$finallyObservers.notify(null, msg);\n            });\n          this.$$observable.notify(promise);\n        });\n    }\n  }\n}\n","import { Vertex } from './vertex.js';\nimport { Task } from './task.js';\nimport { Scheduler } from './scheduler.js';\n\nexport class Graph {\n  constructor() {\n    this.$$vertices = {};\n  }\n  addVertex(id, task = new Task(), scheduler = new Scheduler()) {\n    if (this.$$vertices[id]) {throw new Error('Duplicated vertex entry');}\n    this.$$vertices[id] = new Vertex(task, scheduler, id);\n    return this.$$vertices[id];\n  }\n  order() { return Object.keys(this.$$vertices).length +  Object.getOwnPropertySymbols(this.$$vertices).length; }\n  vertex(id) { return this.$$vertices[id]; }\n}\n","export class CompositeVertex {\n  constructor() {\n  }\n  to(vertex) {return this.output.to(vertex);}\n  err(vertex) {return this.output.err(vertex);}\n  final(vertex) {return this.output.final(vertex);}\n  subscribe(fn) {return this.output.subscribe(fn);}\n  trigger(...input) {return this.input.trigger(...input);}\n  input(vertex) {this.input = vertex;}\n  output(vertex) {this.output = vertex;}\n  $observer() {return this.input.$observer();}\n}","export function dfs(vertex) {\n  const visited = [];\n  visit(vertex.$$observer);\n  return visited;\n  function visit(obs, d = 0, edge = 'origin') {\n    const boundVertex = obs._fn.boundVertex;\n\n    visited.push({ vertex: boundVertex, edge: edge, depth: d });\n\n    for (const obr of boundVertex.$$thenObservers.observers().iterable()) {\n      if (visited.map(x => x.vertex).indexOf(obr._fn.boundVertex) === -1) { visit(obr, d + 1, 'to'); }\n    }\n    for (const obr of boundVertex.$$catchObservers.observers().iterable()) {\n      if (visited.map(x => x.vertex).indexOf(obr._fn.boundVertex) === -1) { visit(obr, d + 1, 'err'); }\n    }\n    for (const obr of boundVertex.$$finallyObservers.observers().iterable()) {\n      if (visited.map(x => x.vertex).indexOf(obr._fn.boundVertex) === -1) { visit(obr, d + 1, 'final'); }\n    }\n  }\n}\n\n// TODO: use template method\nexport function dfsGraph(vertex) {\n  const visited = [];\n  const elements = [];\n  visit(vertex.$$observer);\n  return elements;\n  function visit(obs, d = 0, edge = 'origin') {\n    const boundVertex = obs._fn.boundVertex;\n    visited.push({ vertex: boundVertex, edge: edge, depth: d });\n    elements.push({ data: { id: boundVertex.$$name } });\n    for (const obr of boundVertex.$$thenObservers.observers().iterable()) {\n      if (visited.map(x => x.vertex).indexOf(obr._fn.boundVertex) === -1) {\n        visit(obr, d + 1, 'to');\n      }\n      elements.push({ data: { id: (obs._fn.boundVertex.$$name + obr._fn.boundVertex.$$name), source: obs._fn.boundVertex.$$name, target: obr._fn.boundVertex.$$name } });\n    }\n    for (const obr of boundVertex.$$catchObservers.observers().iterable()) {\n      if (visited.map(x => x.vertex).indexOf(obr._fn.boundVertex) === -1) {\n        visit(obr, d + 1, 'err');\n      }\n      elements.push({ data: { id: (obs._fn.boundVertex.$$name + obr._fn.boundVertex.$$name), source: obs._fn.boundVertex.$$name, target: obr._fn.boundVertex.$$name }, style: { 'line-color': '#d90000', 'target-arrow-color': '#d90000', } });\n    }\n    for (const obr of boundVertex.$$finallyObservers.observers().iterable()) {\n      if (visited.map(x => x.vertex).indexOf(obr._fn.boundVertex) === -1) {\n        visit(obr, d + 1, 'final');\n      }\n      elements.push({ data: { id: (obs._fn.boundVertex.$$name + obr._fn.boundVertex.$$name), source: obs._fn.boundVertex.$$name, target: obr._fn.boundVertex.$$name } });\n    }\n  }\n}\n","/* REactive GRAph FluX ReGraFX.js */\n\nimport { Graph } from './graph.js';\nimport { Vertex } from './vertex.js';\nimport { Task } from './task.js';\nimport { Scheduler } from './scheduler.js';\nimport { Message } from './message.js';\nimport { Observable } from './observable.js';\nimport { Observer } from './observer.js';\nimport { CompositeVertex } from './composite/composite-vertex.js';\nimport { dfs, dfsGraph } from './search/dfs';\n\nconst Search = {\n  dfs: dfs,\n  dfsGraph: dfsGraph\n};\n\nexport {\n  Graph,\n  Vertex,\n  Task,\n  Scheduler,\n  Message,\n  Observable,\n  Observer,\n  CompositeVertex,\n  Search\n};\n"],"names":["Subscription","obj","id","Symbol","unsubscribe","bind","Subscribers","_subscribers","subscription","ids","length","Object","getOwnPropertySymbols","map","s","Observable","subscribers","$$observers","observer","observers","subscribe","iterable","next","Observer","fn","undefined","name","_fn","_name","Scheduler","delay","pauser","_delay","_pause","_pauser","Promise","resolve","reject","setTimeout","isRunning","x","Token","$$symbol","$$date","Date","now","$$cancelled","Message","origin","$$origin","$$token","$$subject","$$signatures","subject","signature","push","$$name","isFunction","value","isPromise","p","then","Task","res","err","Vertex","task","scheduler","$$task","$$scheduler","$$thenObservers","$$catchObservers","$$finallyObservers","$$observable","boundVertexFn","$$next","boundVertex","$$observer","vertex","$observer","msg","input","token","schedule","promise","execute","out","sign","notify","catch","finally","Graph","$$vertices","Error","keys","CompositeVertex","output","to","final","trigger","dfs","visited","visit","obs","d","edge","depth","obr","indexOf","dfsGraph","elements","data","source","target","style","Search"],"mappings":"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"}