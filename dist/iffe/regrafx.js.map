{"version":3,"file":"regrafx.js","sources":["../../src/subscription.js","../../src/subscribers.js","../../src/observable.js","../../src/observer.js","../../src/abstract-scheduler.ts","../../src/schedulers/scheduler.ts","../../src/token.js","../../src/message.js","../../src/tools.js","../../src/task.js","../../src/vertex.js","../../src/graph.js","../../src/schedulers/debounce.ts","../../src/schedulers/throttle.ts","../../src/composite/composite-vertex.js","../../src/search/dfs.js","../../src/regrafx.js"],"sourcesContent":["export class Subscription {\n  constructor(obj) {\n    this.id = Symbol();\n    this.unsubscribe = obj.unsubscribe.bind(obj, this.id);\n  }\n}","import { Subscription } from './subscription.js';\n\nexport class Subscribers {\n  constructor() {\n    this._subscribers = {};\n  }\n  subscribe(obj) {\n    const subscription = new Subscription(this);\n    this._subscribers[subscription.id] = obj;\n    return subscription;\n  }\n  unsubscribe(id) {\n    delete this._subscribers[id];\n  }\n  size() {\n    return this.ids().length;\n  }\n  ids() {\n    return Object.getOwnPropertySymbols(this._subscribers);\n  }\n  get(id) {\n    return this._subscribers[id];\n  }\n  set(obj) {\n    this._subscribers[id] = obj;\n  }\n  iterable() {\n    return Object.getOwnPropertySymbols(this._subscribers).map(s => this._subscribers[s]);\n  }\n}","import {Subscribers} from './subscribers.js';\n\nexport class Observable {\n  constructor(subscribers = new Subscribers() ) {\n    this.$$observers = subscribers;\n  }\n  subscribe(observer) {\n    return this.observers().subscribe(observer);\n  }\n  observers() {\n    return this.$$observers;\n  }\n  unsubscribe(id) {\n    this.observers().unsubscribe(id);\n  }\n  notify(...obj) {\n    for (const observer of this.observers().iterable()) {\n      observer.next(...obj);\n    }\n  }\n}\n","\nexport class Observer {\n  constructor(fn = () => undefined, name = 'Linked Observer') {\n    this._fn = fn;\n    this._name = name;\n  }\n  next(...input) {\n    return this._fn(...input);\n  }\n}\n","export abstract class AbstractScheduler{\n  protected $$delay: number;\n  constructor(delay: number = 0){\n    this.$$delay = delay;\n  }\n  protected abstract schedule() : Promise<any>;\n}\n\nexport interface IPausable{\n  isRunning(): boolean;\n}\n","import { AbstractScheduler } from '../abstract-scheduler';\nimport { IPausable } from '../abstract-scheduler';\nimport { Observable } from '../observable';\n\nexport class Scheduler extends AbstractScheduler implements IPausable {\n  private $$pause: boolean;\n  private $$pauser: Observable;\n  constructor(delay: number = 0, pauser: Observable = new Observable()) {\n    super(delay);\n    this.$$pause = false;\n    this.$$pauser = pauser;\n  }\n  schedule() {\n    return new Promise(resolve => {\n      setTimeout(() => {\n        this.isRunning()\n          ? resolve()\n          : this.$$pauser.subscribe((pause: boolean) => {\n            this.$$pause = pause;\n            if (this.isRunning()) { resolve(); }\n          });\n      }, this.$$delay);\n    });\n  }\n  isRunning() {\n    return !this.$$pause;\n  }\n}\n","export class Token {\n  constructor() {\n    this.$$symbol = Symbol();\n    this.$$date = Date.now();\n    this.$$cancelled = false;\n  }\n  cancel() {\n    this.$$cancelled = true;\n  }\n}","import { Token } from './token';\n\nexport class Message {\n  constructor(origin) {\n    this.$$origin = origin;\n    this.$$date = Date.now();\n    this.$$token = new Token();\n    this.$$subject = null;\n    this.$$signatures = [];\n  }\n  subject(subject) { this.$$subject = subject; return this; }\n  sign(signature) { this.$$signatures.push(signature); return this; }\n  token() {return this.$$token;}\n}\n\nMessage.$$name = 'ReGraFX.Message';\n","export function isFunction(value) {\n  return typeof value === 'function' || false;\n}\n\nexport function isPromise(p) {\n  return p && isFunction(p.then);\n}\n\nexport function isMessage(obj) {\n  return (obj && obj.$$name && obj.$$name === 'ReGraFX.Message');\n}\n","import { isPromise } from './tools.js';\n\nexport class Task {\n  constructor(fn = () => null) {\n    this._fn = fn;\n  }\n  execute(...input) {\n    try {\n      const res = this._fn(...input);\n      return isPromise(res) ? res : Promise.resolve(res);\n    } catch (err) {\n      return Promise.reject(err);\n    }\n  }\n}\n","import { Observable } from './observable.js';\nimport { Observer } from './observer.js';\nimport { Scheduler } from './schedulers/scheduler';\nimport { Message } from './message.js';\nimport { Task } from './task.js';\nexport class Vertex {\n  constructor(task = new Task(), scheduler = new Scheduler(), name = 'Vertex') {\n    this.$$task = task;\n    this.$$scheduler = scheduler;\n    this.$$name = name;\n\n    this.$$thenObservers = new Observable();\n    this.$$catchObservers = new Observable();\n    this.$$finallyObservers = new Observable();\n    this.$$observable = new Observable();\n\n    const boundVertexFn = this.$$next.bind(this);\n    boundVertexFn.boundVertex = this;\n    this.$$observer = new Observer(boundVertexFn, this.$$name);\n  }\n  $observer() {return this.$$observer;}\n  to(vertex) {\n    this.$$thenObservers.subscribe(vertex.$observer());\n    return this;\n  }\n  err(vertex) {\n    this.$$catchObservers.subscribe(vertex.$observer());\n    return this;\n  }\n  final(vertex) {\n    this.$$finallyObservers.subscribe(vertex.$observer());\n    return this;\n  }\n\n  subscribe(fn) {\n    this.$$observable.subscribe(new Observer(fn));\n  }\n\n  trigger(...input) {\n    const msg = new Message();\n    input.push(msg);\n    this.$$observer.next(...input);\n    return msg;\n  }\n  $$next(...input) {\n    const msg = input[input.length - 1];\n    if (!msg.token().$$cancelled) {\n      this.$$scheduler.schedule()\n        .then(() => {\n          const promise = this.$$task.execute(...input);\n          promise\n            .then(out => {\n              msg.sign(this.$$name);\n              this.$$thenObservers.notify(out, msg);\n            })\n            .catch(err => {\n              msg.sign(this.$$name);\n              this.$$catchObservers.notify(err, msg);\n            })\n            .finally(() => {\n              this.$$finallyObservers.notify(null, msg);\n            });\n          this.$$observable.notify(promise);\n        });\n    }\n  }\n}\n","import { Vertex } from './vertex';\nimport { Task } from './task.js';\nimport { Scheduler } from './schedulers/scheduler';\n\nexport class Graph {\n  constructor() {\n    this.$$vertices = {};\n  }\n  addVertex(id, task = new Task(), scheduler = new Scheduler()) {\n    if (this.$$vertices[id]) {throw new Error('Duplicated vertex entry');}\n    this.$$vertices[id] = new Vertex(task, scheduler, id);\n    return this.$$vertices[id];\n  }\n  order() { return Object.keys(this.$$vertices).length +  Object.getOwnPropertySymbols(this.$$vertices).length; }\n  vertex(id) { return this.$$vertices[id]; }\n}\n","import { AbstractScheduler} from '../abstract-scheduler'\n\nexport class Debounce extends AbstractScheduler{\n  private $$timerId: any;\n  constructor(delay: number = 0) {\n    super(delay);\n    this.$$timerId = null;\n  }\n  public schedule() : Promise<any>{\n    return new Promise<any>( resolve  => {\n      if (this.$$timerId) {\n        clearTimeout(this.$$timerId);\n      }\n      this.$$timerId = setTimeout(() => {\n        this.$$timerId = null;\n        resolve();\n      }, this.$$delay);\n    });\n  }\n}\n","import { AbstractScheduler} from '../abstract-scheduler'\n\nexport class Throttle extends AbstractScheduler {\n  private $$timerId: any;\n  constructor(delay: number = 0) {\n    super(delay);\n    this.$$timerId = null;\n  }\n  public schedule() {\n    return new Promise<any>((resolve, reject) => {\n      if (this.$$timerId) {\n        reject();\n      }\n      else {\n        this.$$timerId = setTimeout(() => {\n          this.$$timerId = null;\n        },\n          this.$$delay);\n        resolve();\n      }\n    });\n  }\n}\n","export class CompositeVertex {\n  constructor() {\n  }\n  to(vertex) {return this.output.to(vertex);}\n  err(vertex) {return this.output.err(vertex);}\n  final(vertex) {return this.output.final(vertex);}\n  subscribe(fn) {return this.output.subscribe(fn);}\n  trigger(...input) {return this.input.trigger(...input);}\n  input(vertex) {this.input = vertex;}\n  output(vertex) {this.output = vertex;}\n  $observer() {return this.input.$observer();}\n}","export function dfs(vertex) {\n  const visited = [];\n  visit(vertex.$$observer);\n  return visited;\n  function visit(obs, d = 0, edge = 'origin') {\n    const boundVertex = obs._fn.boundVertex;\n\n    visited.push({ vertex: boundVertex, edge: edge, depth: d });\n\n    for (const obr of boundVertex.$$thenObservers.observers().iterable()) {\n      if (visited.map(x => x.vertex).indexOf(obr._fn.boundVertex) === -1) { visit(obr, d + 1, 'to'); }\n    }\n    for (const obr of boundVertex.$$catchObservers.observers().iterable()) {\n      if (visited.map(x => x.vertex).indexOf(obr._fn.boundVertex) === -1) { visit(obr, d + 1, 'err'); }\n    }\n    for (const obr of boundVertex.$$finallyObservers.observers().iterable()) {\n      if (visited.map(x => x.vertex).indexOf(obr._fn.boundVertex) === -1) { visit(obr, d + 1, 'final'); }\n    }\n  }\n}\n\n// TODO: use template method\nexport function dfsGraph(vertex) {\n  const visited = [];\n  const elements = [];\n  visit(vertex.$$observer);\n  return elements;\n  function visit(obs, d = 0, edge = 'origin') {\n    const boundVertex = obs._fn.boundVertex;\n    visited.push({ vertex: boundVertex, edge: edge, depth: d });\n    elements.push({ data: { id: boundVertex.$$name } });\n    for (const obr of boundVertex.$$thenObservers.observers().iterable()) {\n      if (visited.map(x => x.vertex).indexOf(obr._fn.boundVertex) === -1) {\n        visit(obr, d + 1, 'to');\n      }\n      elements.push({ data: { id: (obs._fn.boundVertex.$$name + obr._fn.boundVertex.$$name), source: obs._fn.boundVertex.$$name, target: obr._fn.boundVertex.$$name } });\n    }\n    for (const obr of boundVertex.$$catchObservers.observers().iterable()) {\n      if (visited.map(x => x.vertex).indexOf(obr._fn.boundVertex) === -1) {\n        visit(obr, d + 1, 'err');\n      }\n      elements.push({ data: { id: (obs._fn.boundVertex.$$name + obr._fn.boundVertex.$$name), source: obs._fn.boundVertex.$$name, target: obr._fn.boundVertex.$$name }, style: { 'line-color': '#d90000', 'target-arrow-color': '#d90000', } });\n    }\n    for (const obr of boundVertex.$$finallyObservers.observers().iterable()) {\n      if (visited.map(x => x.vertex).indexOf(obr._fn.boundVertex) === -1) {\n        visit(obr, d + 1, 'final');\n      }\n      elements.push({ data: { id: (obs._fn.boundVertex.$$name + obr._fn.boundVertex.$$name), source: obs._fn.boundVertex.$$name, target: obr._fn.boundVertex.$$name } });\n    }\n  }\n}\n","/* REactive GRAph FluX ReGraFX */\n\nimport { Graph } from './graph';\nimport { Vertex } from './vertex';\nimport { Task } from './task';\nimport { Scheduler } from './schedulers/scheduler';\nimport { Debounce } from './schedulers/debounce';\nimport { Throttle } from './schedulers/throttle';\nimport { Message } from './message';\nimport { Observable } from './observable';\nimport { Observer } from './observer';\nimport { CompositeVertex } from './composite/composite-vertex';\nimport { dfs, dfsGraph } from './search/dfs';\n\nconst Search = {\n  dfs: dfs,\n  dfsGraph: dfsGraph\n};\n\nexport {\n  Graph,\n  Vertex,\n  Task,\n  Scheduler,\n  Debounce,\n  Throttle,\n  Message,\n  Observable,\n  Observer,\n  CompositeVertex,\n  Search\n};\n"],"names":["Subscription","obj","id","Symbol","unsubscribe","bind","Subscribers","_subscribers","subscription","ids","length","Object","getOwnPropertySymbols","map","s","Observable","subscribers","$$observers","observer","observers","subscribe","iterable","next","Observer","fn","undefined","name","_fn","_name","AbstractScheduler","delay","$$delay","Scheduler","pauser","$$pause","$$pauser","Promise","resolve","setTimeout","isRunning","pause","Token","$$symbol","$$date","Date","now","$$cancelled","Message","origin","$$origin","$$token","$$subject","$$signatures","subject","signature","push","$$name","isFunction","value","isPromise","p","then","Task","res","err","reject","Vertex","task","scheduler","$$task","$$scheduler","$$thenObservers","$$catchObservers","$$finallyObservers","$$observable","boundVertexFn","$$next","boundVertex","$$observer","vertex","$observer","msg","input","token","schedule","promise","execute","out","sign","notify","catch","finally","Graph","$$vertices","Error","keys","Debounce","$$timerId","clearTimeout","Throttle","CompositeVertex","output","to","final","trigger","dfs","visited","visit","obs","d","edge","depth","obr","x","indexOf","dfsGraph","elements","data","source","target","style","Search"],"mappings":"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"}